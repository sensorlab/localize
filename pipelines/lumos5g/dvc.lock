schema: '2.0'
stages:
  download-dataset:
    cmd: "curl --insecure -o data/raw/Lumos5G-v1.0.zip https://lumos5g.umn.edu/downloads/Lumos5G-v1.0.zip\n
      unzip -j data/raw/Lumos5G-v1.0.zip Lumos5G-v1.0/Lumos5G-v1.0.csv -d data/raw/\n
      rm data/raw/Lumos5G-v1.0.zip\n"
    outs:
    - path: data/raw/Lumos5G-v1.0.csv
      hash: md5
      md5: dd525dac43a0823a94e117bbb9a23a14
      size: 8480348
  download:
    cmd: "curl --insecure -o data/raw/Lumos5G-v1.0.zip https://lumos5g.umn.edu/downloads/Lumos5G-v1.0.zip\n
      unzip -j data/raw/Lumos5G-v1.0.zip Lumos5G-v1.0/Lumos5G-v1.0.csv -d data/raw/\n
      rm data/raw/Lumos5G-v1.0.zip\n"
    outs:
    - path: data/raw/Lumos5G-v1.0.csv
      hash: md5
      md5: dd525dac43a0823a94e117bbb9a23a14
      size: 8480348
  prepare:
    cmd: "unzip -j data/raw/Lumos5G-v1.0.zip Lumos5G-v1.0/Lumos5G-v1.0.csv -d data/raw/\n
      python prepare.py --input data/raw/Lumos5G-v1.0.csv --output data/interim/lumos5g.pkl\n
      rm data/raw/Lumos5G-v1.0.csv\n"
    deps:
    - path: data/raw/Lumos5G-v1.0.zip
      hash: md5
      md5: 4f5f75277bd564bb00a23d8e94e11c24
      size: 1604062
    - path: prepare.py
      hash: md5
      md5: fb533bf6db1ddce0f38c4c88025f7341
      size: 2986
    outs:
    - path: data/interim/lumos5g.pkl
      hash: md5
      md5: 9ab1c77407345d4c82615d6b46c9f01b
      size: 9130367
  featurize:
    cmd: "python featurize.py --input data/interim/lumos5g.pkl --output data/prepared/lumos5g.pkl\n"
    deps:
    - path: data/interim/lumos5g.pkl
      hash: md5
      md5: 9ab1c77407345d4c82615d6b46c9f01b
      size: 9130367
    - path: featurize.py
      hash: md5
      md5: f3922d9a867c6c50a12d43924ef2b5f8
      size: 4523
    outs:
    - path: data/prepared/lumos5g.pkl
      hash: md5
      md5: b5c856ba0fc031e57fdeee1da02e074b
      size: 10901113
  fit@KFold:
    cmd: "python split.py --input data/prepared/lumos5g.pkl --split KFold --indices
      data/splits/KFoldSplit.pkl\n"
    deps:
    - path: data/prepared/lumos5g.pkl
      hash: md5
      md5: b5c856ba0fc031e57fdeee1da02e074b
      size: 10901113
    - path: split.py
      hash: md5
      md5: e19e63e3fd0a276f5cd52dbe6d71b00f
      size: 2282
    params:
      params.yaml:
        split:
          seed: 42
          n_splits: 5
          test_size: 0.2
    outs:
    - path: data/splits/KFoldSplit.pkl
      hash: md5
      md5: 8e0253c0cf2d49630b20c8facdbd95f1
      size: 2725514
  benchmark@KFold-LinearRegression:
    cmd: "python ../../scripts/benchmark.py --use LinearRegression --data data/prepared/lumos5g.pkl
      --split-indices data/splits/KFoldSplit.pkl --output-report models/reports/LinearRegression-KFoldSplit.pkl\n"
    deps:
    - path: ../../scripts/benchmark.py
      hash: md5
      md5: f523f601cd2de870c8ce180d73e27ac3
      size: 7464
    - path: data/prepared/lumos5g.pkl
      hash: md5
      md5: b5c856ba0fc031e57fdeee1da02e074b
      size: 10901113
    - path: data/splits/KFoldSplit.pkl
      hash: md5
      md5: 8e0253c0cf2d49630b20c8facdbd95f1
      size: 2725514
    params:
      params.yaml:
        models.LinearRegression:
          pipeline:
          - step: scaler
            module: sklearn.preprocessing
            class: StandardScaler
          - step: regressor
            module: sklearn.multioutput
            class: MultiOutputRegressor
            estimator:
              module: sklearn.linear_model
              class: LinearRegression
              parameters:
                n_jobs: -1
          hyperparameters:
            regressor__estimator__fit_intercept:
            - true
            - false
    outs:
    - path: models/reports/LinearRegression-KFoldSplit.pkl
      hash: md5
      md5: f2ffa52817447880d82a47796addc59f
      size: 2727460
  evaluation:
    cmd: "python ../../scripts/report.py models/reports/*.pkl --output-report reports/metrics.json\n"
    deps:
    - path: ../../scripts/report.py
      hash: md5
      md5: 9a901f85b0972bb3040550b7a0fb73c2
      size: 1500
    - path: models/reports
      hash: md5
      md5: abe54aea5db552cfe9ac1b56d079ee4c.dir
      size: 7637383
      nfiles: 4
    outs:
    - path: reports/metrics.json
      hash: md5
      md5: 230a557dfdb66eb0bfb3aae16d1a1a8c
      size: 677
  benchmark@KFold-XGBRegressor:
    cmd: "python ../../scripts/benchmark.py --use XGBRegressor --data data/prepared/lumos5g.pkl
      --split-indices data/splits/KFoldSplit.pkl --output-report models/reports/XGBRegressor-KFoldSplit.pkl\n"
    deps:
    - path: ../../scripts/benchmark.py
      hash: md5
      md5: f523f601cd2de870c8ce180d73e27ac3
      size: 7464
    - path: data/prepared/lumos5g.pkl
      hash: md5
      md5: b5c856ba0fc031e57fdeee1da02e074b
      size: 10901113
    - path: data/splits/KFoldSplit.pkl
      hash: md5
      md5: 8e0253c0cf2d49630b20c8facdbd95f1
      size: 2725514
    params:
      params.yaml:
        models.XGBRegressor:
          module: xgboost
          class: XGBRegressor
          parameters:
            random_state: 42
            n_jobs: -1
    outs:
    - path: models/reports/XGBRegressor-KFoldSplit.pkl
      hash: md5
      md5: 223b849c8a19895e47a409b8641298c6
      size: 2182464
  benchmark@KFold-RandomForestRegressor:
    cmd: "python ../../scripts/benchmark.py --use RandomForestRegressor --data data/prepared/lumos5g.pkl
      --split-indices data/splits/KFoldSplit.pkl --output-report models/reports/RandomForestRegressor-KFoldSplit.pkl\n"
    deps:
    - path: ../../scripts/benchmark.py
      hash: md5
      md5: f523f601cd2de870c8ce180d73e27ac3
      size: 7464
    - path: data/prepared/lumos5g.pkl
      hash: md5
      md5: b5c856ba0fc031e57fdeee1da02e074b
      size: 10901113
    - path: data/splits/KFoldSplit.pkl
      hash: md5
      md5: 8e0253c0cf2d49630b20c8facdbd95f1
      size: 2725514
    params:
      params.yaml:
        models.RandomForestRegressor:
          module: sklearn.ensemble
          class: RandomForestRegressor
          parameters:
            random_state: 42
            n_jobs: -1
          hyperparameters:
            n_estimators:
            - 10
            - 50
            - 100
            - 250
            - 400
            max_depth:
            - 5
            - 10
            - 30
            - 50
            - 150
            - 200
            -
    outs:
    - path: models/reports/RandomForestRegressor-KFoldSplit.pkl
      hash: md5
      md5: 293a0c03dac41dd6331e5904113d14df
      size: 2727459
